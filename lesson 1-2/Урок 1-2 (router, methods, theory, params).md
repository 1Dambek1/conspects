# **Введение в FastAPI**

**_Что такое FastAPI?_**

  
FastAPI — это фреймворк для создания веб-приложений и API на Python. Он разработан для создания быстрых и эффективных приложений с помощью современных возможностей Python. Основные особенности включают:

1.  Высокая производительность: FastAPI использует Starlette для обработки запросов и Pydantic для валидации данных, что делает его одним из самых быстрых фреймворков для создания API.

2. Автоматическая документация: FastAPI автоматически генерирует документацию API с использованием Swagger UI и ReDoc.

# **_Что такое_** **_backend_****_?_

Бэкенд занимается разработкой серверной части веб-приложений и сайтов. Он отвечает за работу баз данных, серверов и логику, которая происходит на серверной стороне. Frontend, напротив, занимается созданием клиентской части веб-приложений, сайтов, которая взаимодействует с пользователем.

# **_Нужные приложения_****_?_

Вам следует установить [vs_code](https://code.visualstudio.com/) - редактор кода и [обсидиан](https://obsidian.md/) для заметок. Настройки и работа есть в дискорд канале

# **_Создание базового приложения_****_?_

Создайте файл main.py и добавьте следующий код:

```python - main.py

from fastapi import FastAPI # импорт нужного класса Fastapi - главный класс в котором хранится наш бэк

app = FastAPI() # создание нашего приложения, далее будем использовать app, как главное приложение

@app.get("/") # Создание эндпоинта с разными методами, здесь он get и сюда мы передаем path, по которомы мы получим наш ответ
async def read_root(): # создание функции

  return {"Hello": "World"} # Ответ, который вернется кленту 

```

Этот код создаёт веб-сервер, который отвечает на GET-запросы к корневому маршруту (/) с JSON-ответом {"Hello": "World"}. read_root = эндпоинт

Endpoint — это **конечная точка веб-сервиса, к которой клиентское приложение обращается для выполнения определённых операций или получения данных**.

Клие́нт — **аппаратный или программный компонент вычислительной системы, посылающий запросы нашему серверу**.

# **_Запуск сервера_****_?_

  
Uvicorn — **библиотека, позволяющая запустить свой собственный веб-сервер**.
Для запуска нам нужно определить 2 места
1. Где находится наше приложение 
2. На какой порт мы хотим запустить сайт
**Порт - это числовой идентификатор программы или сайта, на котором у нас запущен бэкенд на нашем пк, чтобы у каждого сайта был свой порт, можно сказать, "свое уникальное имя" по которому мы обращаемся **.

Для запуска используем
```cmd
uvicorn path.to.app:name_app --reload --port number
```
--reload - это флаг для того, чтобы при изменении сайта он автоматически изменялся и нам не пришлось самому перезагружать
--port  - Это как раз то уникальное имя, по которому мы зайдем на наш бэк

Потом берем и заходим
 http://127.0.0.1:port - это ссылка на наш сайт, который запущен только на нашем пк. Потом я покажу, как можно сделать его общедоступным.
 Для удобной работы можно зайти на /docs где мы увидим все наши поинты 
 


# HTTP методы и их реализация на FastAPI

## Методы HTTP: Определение и Использование

В современном веб-разработке используются различные HTTP-методы для взаимодействия с сервером. Четыре основных метода:

1. **GET** - используется для запроса данных с сервера.
2. **POST** - используется для отправки данных на сервер.
3. **PUT** - используется для обновления существующих данных на сервере.
4. **DELETE** - используется для удаления данных с сервера.

### 1. `GET`

**Определение**: Метод `GET` используется для получения данных от сервера. Запросы `GET` обычно используются для получения информации, и они не изменяют состояние сервера.

**Пример реализации на FastAPI**:
``` python

from fastapi import FastAPI

app = FastAPI()

@app.method("/items/{item_id}")
async def read_item(item_id: int):
    return {"item_id": item_id, "name": "Sample Item"}


```

### 2. `POST`

**Определение**: Метод `POST` используется для отправки данных на сервер, чтобы создать новый ресурс. В отличие от `GET`, `POST` может содержать данные в теле запроса.
```python

from fastapi import FastAPI
from pydantic import BaseModel

app = FastAPI()

class Item(BaseModel):
    name: str
    description: str | None = None
    price: float
    tax: float | None = None

@app.post("/items/")
async def create_item(item: Item):
    return {"name": item.name, "price": item.price}

```

### 3. `PUT`

**Определение**: Метод `PUT` используется для обновления существующего ресурса на сервере. Если ресурс не существует, он может быть создан. Данные обычно передаются в теле запроса.

```python
from fastapi import FastAPI
from pydantic import BaseModel

app = FastAPI()

class Item(BaseModel):
    name: str
    description: str | None = None
    price: float
    tax: float | None = None

@app.put("/items/{item_id}")
async def update_item(item_id: int, item: Item):
    return {"item_id": item_id, "name": item.name, "price": item.price}

```

### 4. `DELETE`

**Определение**: Метод `DELETE` используется для удаления ресурса на сервере. Он часто используется для удаления элементов по их идентификатору.

```python
from fastapi import FastAPI

app = FastAPI()

@app.delete("/items/{item_id}")
async def delete_item(item_id: int):
    return {"message": f"Item {item_id} has been deleted"}

```



# **_передача данных на сервер_****_?_


Для того чтобы получить данные на бэк есть 2 варианта:

<h2> 1. Через путь </h2> в таком случае

``` python
@app.delete("/items/{item_id}")
async def delete_item(item_id: int):
    return {"message": f"Item {item_id} has been deleted"}
```

Здесь сначала мы передаем переменную в url и далее принимаем ее через функцию, задавая тип, который мы хотим получить через :. В данном примере я смогу передать только число и получу только число. Если я передам другой тип, я получу ошибку.  

```error
Please correct the following validation errors and try again.

- Value must be an integer
```
Такой способ получения через url c [[типизацией]]

<h2>ВАЖНО</h2>
Данный способ можно использовать для всех методов, но такой способ передачи данных небезопасный

<h2> 2. Через тело </h2>
Это способ для большого количества данных, которые нам надо передать безопасно, пряча от "хакеров"


<h2>ВАЖНО</h2>
Данный способ можно использовать для методов передачи данных на сервер(post put) и такой способ передачи данных безопасный, но лучше его использовать только при добавлении записей в бд. Для такого используется pydantic [[lesson 3(pydantic)]]
Который далее мы расмотрим

# FastAPI: Маршрутизаторы (Routers)

## 1. Что такое маршрутизаторы в FastAPI?

Маршрутизаторы (routers) в FastAPI позволяют разбивать приложение на независимые модули или компоненты. Это делает код более организованным и позволяет легко управлять API, особенно при наличии большого числа эндпоинтов.

Маршрутизаторы можно использовать для:
- Организации кода по логическим блокам (например, для разных сущностей или функциональных областей)
- Повторного использования кода в разных проектах
- Изоляции бизнес-логики

---

## 2. Как создать маршрутизатор?

1. **Импортируем `APIRouter` из `fastapi`:**

```python

from fastapi import APIRouter

```

Создаем экземпляр `APIRouter`:

```python
router = APIRouter()

```

Определяем маршруты (роуты) для этого маршрутизатора:

```python
@router.get("/items/")
async def read_items():
    return {"items": ["item1", "item2"]}

```

## Подключение маршрутизаторов к приложению FastAPI

После создания маршрутизатора его необходимо подключить к основному приложению FastAPI:

```python
from fastapi import FastAPI

app = FastAPI()

# Импортируем маршрутизатор
from .routers import items_router

# Подключаем маршрутизатор
app.include_router(items_router)

```
### Примечание:

- `include_router` добавляет все маршруты, определенные в `items_router`, в основное приложение FastAPI.
- Вы можете добавлять префиксы к маршрутизаторам, использовать теги и указывать дополнительные параметры.
## Префиксы для маршрутизаторов

Можно добавлять **префиксы** к маршрутам, чтобы сгруппировать их по категориям:

```python
app.include_router(items_router, prefix="/items")

```

Теперь все маршруты внутри `items_router` будут начинаться с `/items`.

Пример:

```python
@router.get("/")
async def read_items():
    return {"message": "Items"}

```
Этот маршрут будет доступен по адресу `/items/`.

## 5. Теги для маршрутов

Для удобства документации и Swagger UI можно добавлять **теги** к маршрутизаторам:

```python
app.include_router(items_router, tags=["items"])

```

Это сгруппирует все маршруты, относящиеся к этому роутеру, под одним тегом в документации.

## 6. Версии API с маршрутизаторами

Использование маршрутизаторов удобно для создания версионности API:

```python
app.include_router(v1_router, prefix="/v1")
app.include_router(v2_router, prefix="/v2")
```
Это позволит создать отдельные версии API с минимальными усилиями.

## 7. Подключение нескольких маршрутизаторов

FastAPI позволяет подключать несколько маршрутизаторов к одному приложению:
```python
from fastapi import FastAPI app = FastAPI() app.include_router(users_router, prefix="/users", tags=["users"]) app.include_router(items_router, prefix="/items", tags=["items"])
```

Это помогает структурировать приложение и организовывать API в соответствии с различными бизнес-логиками или модулями.

## 8. Полезные советы

- Используйте маршрутизаторы для улучшения структуры больших приложений.
- Разделяйте бизнес-логику и API на независимые модули.
- Добавляйте теги и префиксы для улучшения документации и удобства использования API.